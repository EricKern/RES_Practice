<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>hc08kernel: Address Map</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">hc08kernel
   &#160;<span id="projectnumber">1.00</span>
   </div>
   <div id="projectbrief">Minimal Embedded-Kernel</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Address Map </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>Address Map</h1>
<h2>This is the memory layout of the example implementation</h2>
<h2>Program memory</h2>
<p>Program memory is separated into 2 distinct areas. The upper range, up to 0xffff is used a ROM and will be initialized when the VHDL code is compiled. The ROM can be updated using a special utility which downloads the binary directly into the assosciated block RAMs. The area below is the data area, which gets initialized by the program startup code. It keeps all data and variables, with sme exceptions as described under <a class="el" href="index.html#Tracing">tracing</a>.</p>
<p>The size of both areas can be specified via VHDL generics in multiples of 4kB (powers of 2 * 4K), the default is 8 blocks (32 kB) instruction and 2 blocks (8 kB) data. The same settings must be used by the compile script.</p>
<h3>VHDL Specification</h3>
<p>The generics <code>ni</code> and <code>nd</code> specify the number of 4k blocks for instruction (ni) and data (nd) ram. </p><pre class="fragment">entity hc08_mini_cyc is
   generic (
    ni: integer := 8; -- number of 4k blocks instruction ram, must be power of 2
    nd: integer := 2; -- number of 4k blocks data ram
    ... more generics
    simulation: boolean := false
   );
</pre><h3>Compiler Settings</h3>
<p>To match the compiler settings with the VHDL configuration, specify <code>CSIZE</code> and <code>DSIZE</code> as follows in the build script: </p><pre class="fragment">#### cyc1000: 32k rom, 8k ram
export CSIZE=0x8000
export DSIZE=0x2000
export CLOC=$((0x10000 - $CSIZE))
export SLOC=$(($CLOC - 1))
export DLOC=$(($CLOC - $DSIZE))
# we need to pass the DSEG location for the framebuffer
export CFLAGS="--stack-auto --stack-loc $SLOC -I $INC  -DXSEG=$DLOC "
export LFLAGS="-b HOME=$CLOC -C $CSIZE -b XSEG=$DLOC -X $DSIZE -b DSEG=0x0000 -I 0x80"
</pre><h2>Peripherals</h2>
<p>All basic peripherals are mapped into the address range from 0x80 to 0xff. The range below 0x80 is resevered for RAM and keeps for example the kernel related variables like task, mailbox and mutex states.</p>
<p>Therefore, the peripherals can be acessed using the fast HC08 direct addressing mode, which only works in page 0 (0x00 .. 0xff).</p>
<p>The external SDRAM can be accessed via a register set which allows to read or write sequentially, after setting the start address.</p>
<ul>
<li><a class="el" href="group___g_p_i_o.html">General purpose I/O (LED, Buttons)</a></li>
<li><a class="el" href="group___t_i_m_e_r.html">Timer</a></li>
<li><a class="el" href="group___u_a_r_t.html">UART</a></li>
<li><a class="el" href="group___p_w_m.html">Pulse width modulation</a></li>
<li><a class="el" href="group___i2_c.html">I2C</a></li>
<li><a class="el" href="group___s_d_r_a_m.html">SDRAM</a> </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.14
</small></address>
</body>
</html>
